<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="./../../css/main.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <title>PCShop buy now!</title>
</head>
<body>
    <header class="bg-[#76A793] font-ibrand shadow-xl sticky top-0 mb-5 z-50 w-full h-auto  ">
        <nav class=" mx-5 flex items-center justify-between py-4">
            <!-- Logo -->
            <div class="flex items-center">
                <img src="../../assets/image.webp" alt="not-found" class="h-10 w-10">

                <a href="../../index.html">
                    <span class="ml-8 text-3xl text-white">PCShop</span>
                </a>
            </div>

            <!-- Navigation Links -->
            <div class="lg:flex space-x-12 text-white text-2xl hidden ">
                <a href="/src/pages/who.html" class="hover:underline">Quienes somos</a>
                <a href="/src/pages/team.html" class="hover:underline">Equipo</a>
                <a href="/src/pages/contact.html" class="hover:underline">Contactanos</a>
                <a href="">
                    <i class="fa fa-shopping-cart"></i>
                </a>
            </div>

            <div class="lg:hidden text-white text-2xl" role="dialog" aria-modal="true">
                <!-- Botón para abrir modal -->
                <i class="fa fa-solid fa-bars cursor-pointer" id="open-modal"></i>

                <!-- Fondo del modal -->
                <div id="modal-overlay"
                    class="hidden fixed inset-0 z-10 bg-black bg-opacity-50 transition-opacity duration-300 ease-in-out">
                </div>

                <!-- Contenido del modal -->
                <div id="modal-content"
                    class="hidden fixed inset-y-0 right-0 z-20 w-full sm:max-w-sm bg-[#76A793] p-6 shadow-lg transform translate-x-full transition-transform duration-700 ease-in-out">
                    <div class="flex items-center justify-between">
                        <h2 class="text-xl font-normal">Navegación</h2>
                        <button id="close-modal" class="text-gray-600 hover:text-gray-900">
                            <i class="fa fa-times"></i>
                        </button>
                    </div>
                    <!-- Contenido del modal -->
                    <div class="grid py-10 gap-y-5">
                        <a href="/src/pages/who.html" class="hover:underline">Quienes somos</a>
                        <a href="/src/pages/team.html" class="hover:underline">Equipo</a>
                        <a href="/src/pages/contact.html" class="hover:underline">Contactanos</a>
                        <a href="/src/pages/shop.html">
                            <i class="fa fa-shopping-cart"></i>
                            Carrito
                        </a>
                    </div>

                </div>
            </div>


        </nav>
    </header>
    <div class="buynow-standart-layout">
        <div class="user-layout buynow-from-layout">
            <form class="user-from" id="user-info">
                    <div class="name-cont from-field">
                        <label for="name" required>Name:</label>
                        <input type="text"/>
                    </div>
                    <div class="email-cont from-field">
                        <label for="email" pattern="[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}" requied>Mail:</label>
                        <input type="text">
                    </div>
                    <div class="addres-cont from-field">
                        <label for="address" requied>Address:</label>
                        <input type="text">
                    </div>
                    <div class="payment-cont from-field">
                        <label for="payment" required>Payment:</label>
                        <select name="payment" id="payment">
                            <option value="card">card</option>
                            <option value="cash">cash</option>
                            <option value="bonus">bonus</option>
                            <option value="paypal">paypal</option>
                        </select>
                    </div>
            </form>
        </div>
        <div class="product-buynow-layout buynow-from-layout">
            <div class="image-container">
                <div class="image product-img" id="buynow-image"></div>
            </div>
            <div class="product-info-container">
                <div class="title" id="buynow-title"></div>
                <div class="price-container">
                    <div class="original-price" id="buynow-price"></div>
                    <div class="discount-price" id="discount-price"></div>
                </div>
                <div class="desc" id="buynow-desc"></div>
                <div class="cuant-msg">
                    <span>Cantidad:</span>
                </div>
                <div class="buy-now-cuant">
                    <div class="buynow-less buynow-controller" id="buynow-less" >
                        <i class="fa fa-minus" alt="-"></i>
                    </div>
                    <div class="buynow-cuant" id="buynow-cuant"></div>
                    <div class="buynow-prod buynow-controller" id="buynow-plus" onclick="PlusProd()">
                        <i class="fa fa-plus" alt="+"></i>
                    </div>
                </div>
                <div class="total-wrapp">
                    <span>Total price:</span>
                    <div class="total" id="buynow-total"></div>
                </div>
            </div>
        </div>
        <div class="buynow-controllers-container buynow-from-layout">
            <div class="controllers">
                <div class="cancel" id="cancel">Cancel</div>
                <div class="send-to-cart" id="send-to-cart">Send to cart</div>
                <div class="confirm" id="confirm">Confirm</div>
            </div>
        </div>
    </div>
    <script type="module">
        import Notify from './../components/Notify.js'
        if (localStorage.getItem("username") === null) {
            //...
        } else {
            console.log(localStorage.getItem('username'))
        }
        let product = JSON.parse( localStorage.getItem('scopedProduct') )
        let cuantity = 1
        let price = product.price

        const buyNowImage = document.getElementById('buynow-image')
        const buyNowTitle = document.getElementById('buynow-title')
        const buyNowDesc = document.getElementById('buynow-desc')
        const buyNowPrice = document.getElementById('buynow-price')
        const buyNowCuant = document.getElementById('buynow-cuant')
        const buyNowTotal = document.getElementById('buynow-total')
        const buyNowDiscount = document.getElementById('discount-price')
        const buyNowConfirm = document.getElementById('confirm')
        const buyNowCancel = document.getElementById('cancel')
        const buyNowCart = document.getElementById('send-to-cart')
        const buyNowLess = document.getElementById('buynow-less')
        const buyNowPlus = document.getElementById('buynow-plus')

        buyNowTitle.innerText = product.name;
        buyNowDesc.innerText = product.desc;
        buyNowImage.style.backgroundImage = `url(/../../${product.image})`
        buyNowCuant.innerText = cuantity.toString()
        buyNowPrice.innerHTML = "$"+ product.price.toString()
        if (product.product_object.has_disc){
            price = price - (price * (product.product_object.discount / 100))
            buyNowDiscount.innerText = "$"+price.toString()
            buyNowPrice.classList.add('price-discounted')
        }
        const ValidateForm = () => {
            //document.querySelector('#user-info').children[0].children[1].value
            let form = document.getElementById('user-info')
            let elements = form.children
            console.log(elements)
            for (let index = 0; index < elements.length; index++) {
                let element = elements[index];
                if (element[index].children[1].value === ""){
                    return false
                }
                
            }
            return true
            // console.log(values)
        }
        const SaleConfirmed = () => {
            let dialog = document.createElement('dialog')
            let message = document.createElement('h1')
            let subtitle = document.createElement('h3')
            dialog.classList.add('sale-dialog')
            message.classList.add('sale-message')
            message.innerText = "Sale Confirmed!"
            subtitle.innerText = "you can track you shipp with our app"
            subtitle.classList.add('sale-subtitle')
            dialog.appendChild(message)
            dialog.appendChild(subtitle)
            document.body.appendChild(dialog)
            dialog.showModal()
            setTimeout(() => {
                dialog.close()
                window.location = window.location.origin
            }, 2000)
        }
        const UpdateTotal = () => {
            buyNowTotal.textContent = "$" + (Number(price) * Number(cuantity))
            buyNowCuant.innerText = cuantity.toString()
        }
        const PlusProd = () => {
            cuantity = cuantity + 1
            UpdateTotal()
        }
        const LessProd = () => {
            if (cuantity > 1){
                cuantity = cuantity - 1
                UpdateTotal()
            }
        }
        buyNowCart.addEventListener('click', () => {
            Notify.info('producto agregado al carrito')
        })
        buyNowLess.addEventListener('click', () =>{    LessProd()})
        buyNowPlus.addEventListener('click', () =>{    PlusProd()})
        document.getElementById('cancel').addEventListener('click', () => {
            window.location = window.location.origin
        })
        buyNowConfirm.addEventListener('click', SaleConfirmed)
        UpdateTotal()
    </script>
</body>
</html>